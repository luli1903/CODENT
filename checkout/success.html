<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pago aprobado | CODENT</title>
  <link rel="stylesheet" href="/css/checkout-status.css">
</head>
<body>
  <main class="status-wrap is-success">
    <section class="status-card">
      <header class="status-head">
        <div class="status-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="26" height="26" fill="currentColor"><path d="M9 16.2l-3.5-3.5L4 14.2 9 19l12-12-1.5-1.5z"/></svg>
        </div>
        <div>
          <h1 class="status-title">¡Pago aprobado!</h1>
          <p class="status-sub">Gracias por tu compra. Te enviamos el detalle por email.</p>
        </div>
      </header>

      <div id="details" class="details"></div>

      <div class="actions">
        <a class="btn btn-primary" href="/tienda.html">Volver a la tienda</a>
        <a id="btnOrder" class="btn btn-outline" href="#">Ver pedido</a>
      </div>
      <p class="note">Te redirigimos en <span id="sec">8</span> s…</p>
    </section>
  </main>

  <script>
    const q = new URLSearchParams(location.search);
    const kv = (k, label) => q.get(k) ? `<div class="kv"><small>${label}</small><strong>${q.get(k)}</strong></div>` : "";
    details.innerHTML = [
      kv("payment_id","ID de pago"),
      kv("status","Estado"),
      kv("preference_id","Preferencia"),
      kv("external_reference","Referencia"),
      kv("collection_id","Colección")
    ].join("");

    const ref = q.get("external_reference");
    if (ref) btnOrder.href = `/pedido.html?ref=${encodeURIComponent(ref)}`; else btnOrder.style.display = "none";

    let s=8; const t=setInterval(()=>{ sec.textContent=--s; if(s<=0){clearInterval(t); location.href="/tienda.html";}},1000);
  </script>
</body>
</html>
